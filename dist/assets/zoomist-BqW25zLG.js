var jt=Object.defineProperty,It=(s,t,e)=>t in s?jt(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,z=(s,t,e)=>(It(s,typeof t!="symbol"?t+"":t,e),e),Mt=(s,t,e)=>{if(!t.has(s))throw TypeError("Cannot "+e)},w=(s,t,e)=>{if(t.has(s))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(s):t.set(s,e)},E=(s,t,e)=>(Mt(s,t,"access private method"),e);const F=s=>document.contains(M(s)),kt=s=>{if(!s)return!1;try{const{constructor:t}=s,{prototype:e}=t,{hasOwnProperty:i}=Object.prototype;return t&&e&&i.call(e,"isPrototypeOf")}catch{return!1}},gt=s=>typeof s=="function",W=s=>!isNaN(Number(s)),B=s=>s==null,M=s=>s instanceof HTMLElement?s:document.querySelector(s),S=s=>{const t="touches"in s?s.touches[0]:s;return{clientX:t.clientX,clientY:t.clientY}},C=s=>({clientX:[...s].map(t=>t.clientX).reduce((t,e)=>t+e)/s.length,clientY:[...s].map(t=>t.clientY).reduce((t,e)=>t+e)/s.length}),y=s=>{const{width:t,height:e,top:i,left:o,bottom:h}=s.getBoundingClientRect();return{width:t,height:e,top:i,left:o,bottom:h}},ft=s=>s.length>=2?Math.hypot(s[0].clientX-s[1].clientX,s[0].clientY-s[1].clientY):0,x=(s,t)=>{for(const[e,i]of Object.entries(t))typeof i=="string"&&s.style.setProperty(e,i)},L=(s,t)=>{for(const[e,i]of Object.entries(t))s.setAttribute(e,i)},v=(s,t)=>{for(const[e,i]of Object.entries(t))s[e]=i},Y=(s,t,e)=>Math.min(Math.max(s,t),e),$=s=>{const t=+(Math.round(+(s+"e+2"))+"e-2");return isNaN(t)?0:t},pt=s=>{throw new Error(s)},P=s=>console.warn(s),D=(s="div",t,e,i)=>{const o=document.createElement(s);return t&&o.classList.add(...t.split(" ")),e&&L(o,e),i&&(o.innerHTML=i),o},f="zoomist",Nt=`${f}-container`,_t=`${f}-wrapper`,q=`${f}-image`,T=`${f}-slider`,Ht=`${f}-slider-wrapper`,At=`${f}-slider-bar`,Bt=`${f}-slider-button`,N=`${f}-zoomer`,Ft=`${f}-zoomer-button`,ot=`${f}-zoomer-icon`,rt=`${f}-zoomer-in`,at=`${f}-zoomer-out`,lt=`${f}-zoomer-reset`,Pt=`${f}-zoomer-disabled`,qt={tabindex:"0",role:"slider","aria-label":"slider for zoomist","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":"0","aria-disabled":"false"},ht={tabindex:"0",role:"button",type:"button","aria-disabled":"false"},Vt={...ht,"aria-label":"button for zoom in zoomist"},Zt={...ht,"aria-label":"button for zoom out zoomist"},Ut={...ht,"aria-label":"button for reset zoomist scale"},Gt=typeof window<"u"&&typeof window.document<"u",X=!!(Gt&&"ontouchstart"in window),Jt=X?"touchstart":"mousedown",R=X?"touchmove":"mousemove",j=X?"touchend":"mouseup",Kt="wheel",Qt=["left","right","center"],te=["top","bottom","center"],vt="--scale",bt="--translate-x",wt="--translate-y",ee="--value",Ot={draggable:!0,wheelable:!0,pinchable:!0,bounds:!0,zoomRatio:.1,maxScale:10,minScale:1,initScale:null},se={el:null,direction:"horizontal"},ie={el:`.${T}`},ne={el:null,inEl:null,outEl:null,resetEl:null,disabledClass:Pt},oe={el:`.${N}`,inEl:`.${rt}`,outEl:`.${at}`,resetEl:`.${lt}`},re={ready:null,reset:null,resize:null,beforeDestroy:null,destroy:null,beforeUpdate:null,update:null,zoom:null,wheel:null,dragStart:null,drag:null,dragEnd:null,pinchStart:null,pinch:null,pinchEnd:null,slideStart:null,slide:null,slideEnd:null},ae={slider:null,zoomer:null},le=`
<svg viewBox="0 0 12 12" class="${ot}">
  <polygon points="12,5.5 6.5,5.5 6.5,0 5.5,0 5.5,5.5 0,5.5 0,6.5 5.5,6.5 5.5,12 6.5,12 6.5,6.5 12,6.5 "/>
</svg>
`,he=`
<svg viewBox="0 0 12 12" class="${ot}">
  <rect y="5.5" width="12" height="1"/>
</svg>
`,ce=`
<svg viewBox="0 0 12 12" class="${ot}">
  <path d="m7.45,1.27l.35-.22c.26-.17.34-.52.17-.78-.17-.27-.52-.34-.78-.17l-1.54.99-.19.13-.11.46,1.12,1.75c.11.17.29.26.48.26.1,0,.21-.03.31-.09.26-.17.34-.52.17-.78l-.29-.46c1.85.5,3.22,2.17,3.22,4.18,0,2.39-1.95,4.34-4.34,4.34S1.66,8.92,1.66,6.52c0-1.15.44-2.23,1.25-3.05.22-.22.22-.58,0-.8-.22-.22-.58-.22-.8,0-1.02,1.03-1.58,2.4-1.58,3.85,0,3.02,2.46,5.48,5.48,5.48s5.48-2.46,5.48-5.48c0-2.51-1.71-4.62-4.02-5.26Z"/>
</svg>
`,de={on(s,t){if(!t||!gt(t))return this;const{__events__:e}=this;return s.split(" ").forEach(i=>{const o=i;e[o]||(e[o]=[]),e[o].push(t)}),this},emit(s,...t){const{__events__:e}=this;return e[s]?(e[s].forEach(i=>{gt(i)&&i.apply(this,t)}),this):this},zoom(s,t){const{scale:e}=this.transform,i=this.useFixedRatio($(e*(s+1)));return e===i?this:(this.zoomTo(i,t),this)},zoomTo(s,t=!0){const{image:e,transform:{scale:i,translateX:o,translateY:h},options:{bounds:r}}=this;if(s=this.useFixedRatio(s),s===i)return this;if(this.transform.scale=s,!t)return this.emit("zoom",this,this.transform.scale),this;t=typeof t=="boolean"?this.getContainerCenterClient():t;const{clientX:n,clientY:a}=t,{top:c,left:u,width:m,height:l}=y(e),{width:d,height:g}=this.getImageDiff(),p=s/i-1,b=(m/2-n+u)*p+o,_=(l/2-a+c)*p+h,k=r?Y(b,d,-d):b,O=r?Y(_,g,-g):_;return v(this.transform,{translateX:k,translateY:O}),this.emit("zoom",this,this.transform.scale),this},move(s){const{options:{bounds:t},transform:{translateX:e,translateY:i}}=this,{x:o,y:h}=s,{width:r,height:n}=this.getImageDiff();if(W(o)){const a=e+o,c=t?Y(a,r,-r):a;this.transform.translateX=c}if(W(h)){const a=i+h,c=t?Y(a,n,-n):a;this.transform.translateY=c}return this},moveTo(s){const{options:{bounds:t}}=this,{x:e,y:i}=s,{width:o,height:h}=this.getImageDiff();if(W(e)){const r=Number(e),n=t?Y(r,o,-o):r;this.transform.translateX=n}if(Qt.some(r=>r===e)){const r={left:-o,right:o,center:0}[e];this.transform.translateX=r}if(W(i)){const r=Number(i),n=t?Y(r,h,-h):r;this.transform.translateY=n}if(te.some(r=>r===i)){const r={top:-h,bottom:h,center:0}[i];this.transform.translateY=r}return this},slideTo(s){const{options:{minScale:t,maxScale:e}}=this,i=(e-t)*s/100+t;return this.zoomTo(i),this},reset(){const{options:{initScale:s}}=this;return v(this.transform,{scale:s,translateX:0,translateY:0}),this.emit("reset",this),this},destroy(s=!1){const{element:t,image:e,controller:i}=this;return this.mounted&&(this.emit("beforeDestroy",this),i.abort(),this.destroyModules(),s&&e&&(this.reset(),e.removeAttribute("style")),t[f]=null,this.mounted=!1,this.emit("destroy",this)),null},update(s){const{element:t,controller:e}=this;return this.emit("beforeUpdate",this),t[f]=null,this.mounted=!1,e.abort(),this.destroyModules(),s&&(this.options=Object.assign({},Ot,kt(s)&&s)),this.init(),this.emit("update",this),this},getImageData(){return{...this.data.imageData}},getContainerData(){return{...this.data.containerData}},getSliderValue(){const{__modules__:{slider:s}}=this;return s&&s.value!==void 0?s.value:null},getImageDiff(){const{width:s,height:t}=this.getContainerData(),{width:e,height:i}=this.getImageData();return{width:(s-e)/2,height:(t-i)/2}},getContainerCenterClient(){const{element:s}=this,{top:t,left:e,width:i,height:o}=y(s);return{clientX:e+i/2,clientY:t+o/2}},getScaleRatio(){const{transform:{scale:s},options:{minScale:t,maxScale:e}}=this;return(s-t)/(e-t)},useFixedRatio(s){const{options:{minScale:t,maxScale:e}}=this;return Y(s,t,e)}},{defineProperty:I}=Object;var V,Wt,Z,Et,U,zt,G,St,J,yt,K,Yt,Q,Xt,tt,$t,et,xt,st,Dt,it,Lt,nt,Tt;class me{constructor(t,e){w(this,V),w(this,Z),w(this,U),w(this,G),w(this,J),w(this,K),w(this,Q),w(this,tt),w(this,et),w(this,st),w(this,it),w(this,nt),z(this,"element"),z(this,"options"),z(this,"wrapper"),z(this,"image"),z(this,"mounted"),z(this,"data"),z(this,"transform"),z(this,"states"),z(this,"controller"),z(this,"__events__"),z(this,"__modules__"),t||pt("The first argument is required."),F(t)||pt(`Element ${t} is not exist.`),this.element=M(t),this.options=Object.assign({},Ot,kt(e)&&e),this.init()}init(){const{element:t}=this,{options:{bounds:e,minScale:i,maxScale:o,initScale:h}}=this;if(t[f])return;t[f]=this;const r=t.querySelector(`.${_t}`),n=t.querySelector(`.${q}`);if(!r)return P(`${f} needs a ".${_t}" element.`);if(!n)return P(`${f} needs a ".${q}" element.`);this.options.minScale=e&&i<1?1:i,this.options.maxScale=Math.max(o,i),this.options.initScale=Y(h||i,i,o),this.wrapper=r,this.image=n,E(this,V,Wt).call(this)}destroyModules(){const{slider:t,zoomer:e}=this.__modules__;t&&this.destroySlider(),e&&this.destroyZoomer()}destroySlider(){var t,e;const{__modules__:{slider:i}}=this;if(!i||!i.mounted)return;const{options:{el:o},controller:h}=i;o===`.${T}`?(t=i.sliderEl)==null||t.remove():(e=i.sliderTrack)==null||e.remove(),h==null||h.abort(),i.mounted=!1}destroyZoomer(){const{__modules__:{zoomer:t}}=this;if(!t||!t.mounted)return;const{options:{el:e,inEl:i,outEl:o,resetEl:h},controller:r,zoomerEl:n,zoomerInEl:a,zoomerOutEl:c,zoomerResetEl:u}=t,m=(l,d,g)=>{l===`.${d}`&&(g==null||g.remove())};[{target:e,className:N,el:n},{target:i,className:rt,el:a},{target:o,className:at,el:c},{target:h,className:lt,el:u}].forEach(l=>m(l.target,l.className,l.el)),r==null||r.abort(),t.mounted=!1}}V=new WeakSet,Wt=function(){const{element:s,image:t,options:e}=this,{draggable:i,pinchable:o}=e,{offsetWidth:h,offsetHeight:r}=s,{offsetWidth:n,offsetHeight:a}=t,{width:c,height:u}=y(t);if(!n||!a)return P(`The width or height of ${q} should not be 0.`);if(this.transform={scale:0,translateX:0,translateY:0},this.data={imageData:{originWidth:n,originHeight:a,width:c,height:u},containerData:{width:h,height:r}},X&&(i||o)&&(this.data.touchData={hypot:0,startX:0,startY:0,prevX:0,prevY:0,imageTop:0,imageLeft:0,widthDiff:0,heightDiff:0}),!X&&i&&(this.data.dragData={startX:0,startY:0}),this.__events__={...re},e.on)for(const[m,l]of Object.entries(e.on))this.__events__[m]=[l];if(this.__modules__={...ae},e.slider){const m=e.slider===!0?ie:e.slider;this.__modules__.slider={options:Object.assign({},se,m)}}if(e.zoomer){const m=e.zoomer===!0?oe:e.zoomer;this.__modules__.zoomer={options:Object.assign({},ne,m)}}this.controller=new AbortController,E(this,Z,Et).call(this)},Z=new WeakSet,Et=function(){if(this.mounted)return;const{element:s,image:t,options:{minScale:e,maxScale:i,initScale:o},__modules__:{slider:h,zoomer:r}}=this,n=this;x(t,{transform:`
        translate(var(${bt}, 0px), var(${wt}, 0px))
        scale(var(${vt}, 0))`}),I(this.transform,"scale",{get(){return n.transform.__scale__},set(a){const c=n.useFixedRatio(a);if(!(B(c)||n.transform.__scale__===c)){if(n.transform.__scale__=c,x(t,{[vt]:c.toString()}),v(n.data.imageData,{width:y(t).width,height:y(t).height}),h){const u=Math.round(n.getScaleRatio()*100);h.value=u}if(r&&r.options.disabledClass){const{zoomerInEl:u,zoomerOutEl:m,zoomerResetEl:l,options:{disabledClass:d}}=r;u&&(u.classList[c===i?"add":"remove"](d),L(u,{"aria-disabled":c===i?"true":"false"})),m&&(m.classList[c===e?"add":"remove"](d),L(m,{"aria-disabled":c===e?"true":"false"})),l&&(l.classList[c===o?"add":"remove"](d),L(l,{"aria-disabled":c===o?"true":"false"}))}}}}),I(this.transform,"translateX",{get(){return n.transform.__translateX__},set(a){const c=$(a);B(c)||n.transform.__translateX__===c||(n.transform.__translateX__=c,x(t,{[bt]:`${c}px`}))}}),I(this.transform,"translateY",{get(){return n.transform.__translateY__},set(a){const c=$(a);B(c)||n.transform.__translateY__===c||(n.transform.__translateY__=c,x(t,{[wt]:`${c}px`}))}}),E(this,U,zt).call(this),E(this,tt,$t).call(this),v(this.transform,{scale:o,translateX:0,translateY:0}),s.classList.add(Nt),this.mounted=!0,this.emit("ready",this)},U=new WeakSet,zt=function(){const{wrapper:s,options:t,controller:{signal:e}}=this,{draggable:i,pinchable:o,wheelable:h}=t;if(this.states={},h){this.states.wheeling=!1;const r=n=>E(this,G,St).call(this,n);s.addEventListener(Kt,r,{signal:e})}if(X&&(i||o)){i&&(this.states.dragging=!1),o&&(this.states.pinching=!1);const r=n=>E(this,K,Yt).call(this,n);s.addEventListener("touchstart",r,{signal:e})}if(!X&&i){this.states.dragging=!1;const r=n=>E(this,J,yt).call(this,n);s.addEventListener("mousedown",r,{signal:e})}E(this,Q,Xt).call(this)},G=new WeakSet,St=function(s){const{options:t}=this,{zoomRatio:e}=t;if(s.preventDefault(),this.states.wheeling)return;this.states.wheeling=!0,setTimeout(()=>{this.states.wheeling=!1},30);const i=(s.deltaY||s.detail)>0?-1:1;this.zoom(i*e,S(s)),this.emit("wheel",this,this.transform.scale,s)},J=new WeakSet,yt=function(s){const{data:t,transform:e}=this,{dragData:i,imageData:o}=t;if(!i||!o)return;const h=a=>{a&&a.button!==0||(v(i,{startX:S(a).clientX,startY:S(a).clientY}),this.states.dragging=!0,this.emit("dragStart",this,{x:e.translateX,y:e.translateY},a),document.addEventListener(R,r),document.addEventListener(j,n))},r=a=>{if(a.touches||!this.states.dragging)return;const c=S(a).clientX,u=S(a).clientY,m=c-i.startX+e.translateX,l=u-i.startY+e.translateY;this.moveTo({x:m,y:l}),v(i,{startX:S(a).clientX,startY:S(a).clientY}),this.emit("drag",this,{x:m,y:l},a)},n=a=>{a.touches||(this.states.dragging=!1,this.emit("dragEnd",this,{x:e.translateX,y:e.translateY},a),document.removeEventListener(R,r),document.removeEventListener(j,n))};h(s)},K=new WeakSet,Yt=function(s){const{data:t,transform:e,options:{maxScale:i,minScale:o,draggable:h,pinchable:r}}=this,{touchData:n,imageData:a}=t;if(!n||!a)return;const c=l=>{const d=l.touches;if(!d)return;const{top:g,left:p}=y(this.image),{width:b,height:_}=this.getImageDiff();v(n,{hypot:ft(d),startX:C(d).clientX,startY:C(d).clientY,prevX:0,prevY:0,imageTop:g,imageLeft:p,widthDiff:b,heightDiff:_}),h&&(this.states.dragging=!0,this.emit("dragStart",this,{x:e.translateX,y:e.translateY},l)),r&&d.length===2&&(this.states.pinching=!0,this.emit("pinchStart",this,e.scale,l)),document.addEventListener("touchmove",u),document.addEventListener("touchend",m)},u=l=>{const d=l.touches;if(!d)return;const{states:{dragging:g,pinching:p}}=this,{top:b,left:_}=y(this.image),{width:k,height:O}=this.getImageDiff(),H=ft(d),ct=H?H/n.hypot:1,A=this.useFixedRatio(ct*e.scale),dt=C(d).clientX+n.prevX,mt=C(d).clientY+n.prevY;if(p&&d.length===2&&this.zoomTo(A,!1),g){const ut=A!==i&&A!==o&&r?ct:1,Ct=$(dt-n.imageLeft-(k-n.widthDiff)-(n.startX-n.imageLeft)*ut+e.translateX),Rt=$(mt-n.imageTop-(O-n.heightDiff)-(n.startY-n.imageTop)*ut+e.translateY);this.moveTo({x:Ct,y:Rt})}v(n,{hypot:H,startX:dt,startY:mt,imageTop:b,imageLeft:_,widthDiff:k,heightDiff:O}),p&&d.length===2&&this.emit("pinch",this,e.scale,l),g&&this.emit("drag",this,{x:e.translateX,y:e.translateY},l)},m=l=>{const d=l.touches;if(!d)return;const{states:{dragging:g,pinching:p}}=this;if(g&&!d.length&&(this.states.dragging=!1,this.emit("dragEnd",this,{x:e.translateX,y:e.translateY},l)),p&&d.length<2&&(this.states.pinching=!1,this.emit("pinchEnd",this,e.scale,l)),g&&d.length===1){const b=S(l).clientX,_=S(l).clientY;v(n,{prevX:n.startX-b,prevY:n.startY-_})}d.length||(document.removeEventListener("touchmove",u),document.removeEventListener("touchend",m))};c(s)},Q=new WeakSet,Xt=function(){const{element:s,image:t,transform:e}=this;new ResizeObserver(()=>{const{offsetWidth:i,offsetHeight:o}=s,{width:h,height:r}=this.getContainerData();if(i===h&&o===r)return;const n=e.translateX,a=e.translateY;if(n){const d=i/h*n;this.transform.translateX=d}if(a){const d=o/r*a;this.transform.translateY=d}const{offsetWidth:c,offsetHeight:u}=t,{width:m,height:l}=y(t);v(this.data.containerData,{width:i,height:o}),v(this.data.imageData,{originWidth:c,originHeight:u,width:m,height:l}),this.emit("resize",this)}).observe(s)},tt=new WeakSet,$t=function(){const{slider:s,zoomer:t}=this.__modules__;s&&E(this,et,xt).call(this),t&&E(this,it,Lt).call(this)},et=new WeakSet,xt=function(){const{element:s,__modules__:{slider:t}}=this;if(!t||t.mounted)return;const{options:{el:e,direction:i}}=t,o=e===`.${T}`;if(!e||!o&&!F(e))return;const h=o?D("div",T):M(e),r=D("div",Ht),n=D("span",At),a=D("span",Bt,{...qt,"aria-orientation":i});h.classList.add(`${T}-${i}`),I(t,"value",{get(){return t.__value__},set(c){t.__value__!==c&&(t.__value__=c,x(h,{[ee]:c.toString()}),L(a,{"aria-valuenow":c.toString()}))}}),v(t,{value:this.getScaleRatio()*100,controller:new AbortController,sliding:!1,sliderEl:h,sliderTrack:r,sliderButton:a}),E(this,st,Dt).call(this),r.append(n,a),h.append(r),o&&s.append(h),t.mounted=!0},st=new WeakSet,Dt=function(){const{options:{minScale:s,maxScale:t},__modules__:{slider:e}}=this;if(!e)return;const{options:{direction:i},controller:o,sliderEl:h,sliderTrack:r}=e;if(!h||!r)return;const n=i==="vertical",a=l=>{const d=y(r),g=d[n?"height":"width"],p=d[n?"bottom":"left"],b=S(l)[n?"clientY":"clientX"],_=$(Y((b-p)*(n?-1:1)/g,0,1));return(t-s)*_+s},c=l=>{if(l instanceof MouseEvent&&l.button!==0)return;e.sliding=!0;const d=a(l);this.zoomTo(d),this.emit("slideStart",this,this.getSliderValue(),l),document.addEventListener(R,u),document.addEventListener(j,m)},u=l=>{if(!e.sliding)return;const d=a(l);this.zoomTo(d),this.emit("slide",this,this.getSliderValue(),l)},m=l=>{this.emit("slideEnd",this,this.getSliderValue(),l),e.sliding=!1,document.removeEventListener(R,u),document.removeEventListener(j,m)};h.addEventListener(Jt,c,{signal:o==null?void 0:o.signal})},it=new WeakSet,Lt=function(){const{element:s,__modules__:{zoomer:t}}=this;if(!t||t.mounted)return;const{options:{el:e,inEl:i,outEl:o,resetEl:h}}=t,r=[i,o,h],n=(l,d,g,p,b)=>{const _=l===`.${g}`;return!l||!_&&!F(l)?null:(g=r.includes(l)?`${g} ${Ft}`:g,_?D(d,g,p,b):M(l))},a=n(e,"div",N),c=n(i,"button",rt,Vt,le),u=n(o,"button",at,Zt,he),m=n(h,"button",lt,Ut,ce);v(t,{controller:new AbortController,zoomerEl:a,zoomerInEl:c,zoomerOutEl:u,zoomerResetEl:m}),a&&(c&&a.append(c),u&&a.append(u),m&&a.append(m),e===`.${N}`&&s.append(a)),E(this,nt,Tt).call(this),t.mounted=!0},nt=new WeakSet,Tt=function(){const{options:{zoomRatio:s},__modules__:{zoomer:t}}=this,e=this;if(!t)return;const{controller:i,zoomerInEl:o,zoomerOutEl:h,zoomerResetEl:r}=t;o&&o.addEventListener("click",()=>{e.zoom(s)},{signal:i==null?void 0:i.signal}),h&&h.addEventListener("click",()=>{e.zoom(-s)},{signal:i==null?void 0:i.signal}),r&&r.addEventListener("click",()=>{e.reset()},{signal:i==null?void 0:i.signal})};Object.assign(me.prototype,de);export{me as m};
